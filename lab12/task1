using System;
using System.Windows.Forms;
using static System.Windows.Forms.VisualStyles.VisualStyleElement;
namespace OrderPipeline
{
    public partial class Form1 : Form
    {
        public event EventHandler<ShipEventArgs> OrderCreated;
        public event EventHandler OrderRejected;
        public event EventHandler<string> OrderConfirmed;
        public Form1()
        {
            InitializeComponent();
            // Subscribers
            OrderCreated += ValidateOrder;
            OrderCreated += DisplayOrderInfo;

            OrderRejected += ShowRejection;

            OrderConfirmed += ShowConfirmation;
        }
        private void Form1_Load(object sender, EventArgs e)
        {
        }
        private void btnProcessOrder_Click(object sender, EventArgs e)
        {
            string customer = txtCustomer.Text;
            string product = comboBox1.SelectedItem?.ToString();
            int quantity = (int)numericUpDown1.Value;

            // Express = false for Task 1
            ShipEventArgs args = new ShipEventArgs(product, false);
            // Fire the first event
            OrderCreated?.Invoke(this, args);
        }
        private void label2_Click(object sender, EventArgs e)
        {
        }
        private void ValidateOrder(object? sender, ShipEventArgs e)
        {
            int quantity = (int)numericUpDown1.Value;
            if (quantity <= 0)
            {
                OrderRejected?.Invoke(this, EventArgs.Empty);
                return;
            }
            lblStatus.Text = "Validated";
            string customer = txtCustomer.Text;
            OrderConfirmed?.Invoke(this, customer);
        }
        private void DisplayOrderInfo(object sender, ShipEventArgs e)
        {
            MessageBox.Show($"Product: {e.Product}\nExpress: {e.Express}");
        }

        private void ShowRejection(object? sender, EventArgs e)
        {
            lblStatus.Text = "Order Invalid â€“ Please retry";
        }
        private void ShowConfirmation(object? sender, string customer)
        {
            lblStatus.Text = $"Order Processed Successfully for {customer}";
        }
    }
    public class ShipEventArgs : EventArgs
    {
        public string Product { get; }
        public bool Express { get; }
        public ShipEventArgs(string p, bool ex)
        {
            Product = p;
            Express = ex;
        }
    }
}
